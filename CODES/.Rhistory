scale_fill_manual(values = c("ns" = "gray")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),
axis.title = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "none"  # Hide legend (we'll keep it in LH plot)
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)", y = "Visual Cortex Region")
# Left Hemisphere (LH) Plot - Normal X-axis
p_lh <- ggplot(subset(results, Hemisphere == "lh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray")) +  # Customize colors
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_blank(),  # Hide y-axis labels for LH (keep only RH)
axis.title = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "right"  # Show legend only in LH plot
) +
labs(title = "Left Hemisphere", x = "Mean Difference (3D - 2D)", y = "")
# Merge the two plots side-by-side
p_rh + p_lh
# Left Hemisphere (LH) Plot - Normal X-axis
p_lh <- ggplot(subset(results, Hemisphere == "lh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray")) +  # Customize colors
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_blank(),  # Hide y-axis labels for LH (keep only RH)
axis.title = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "right"  # Show legend only in LH plot
) +
labs(title = "Left Hemisphere", x = "Mean Difference (3D - 2D)", y = "")
# Right Hemisphere (RH) Plot - Reverse X-axis
p_rh <- ggplot(subset(results, Hemisphere == "rh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),
axis.title = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "none"  # Hide legend (we'll keep it in LH plot)
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)", y = "Visual Cortex Region")
# Merge the two plots side-by-side
p_rh + p_lh
p_lh+p_rh
# Right Hemisphere (RH) Plot - Reverse X-axis
p_rh <- ggplot(subset(results, Hemisphere == "rh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for RH
axis.title.y = element_blank(),  # Remove y-axis title (keep it only in LH)
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "none"  # Hide legend (we'll keep it in LH plot)
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)")
# Left Hemisphere (LH) Plot - Normal X-axis
p_lh <- ggplot(subset(results, Hemisphere == "lh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for LH
axis.title.y = element_text(size = 16),  # Keep y-axis title for LH
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "right"  # Show legend only in LH plot
) +
labs(title = "Left Hemisphere", x = "Mean Difference (3D - 2D)", y = "Visual Cortex Region", fill = "Significance")
# Merge the two plots side-by-side
p_lh+p_rh
# Right Hemisphere (RH) Plot - Reverse X-axis
p_rh <- ggplot(subset(results, Hemisphere == "rh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for RH
axis.title.y = element_blank(),  # Remove y-axis title (keep it only in LH)
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "none"  # Hide legend (we'll keep it in LH plot)
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)")
# Left Hemisphere (LH) Plot - Normal X-axis
p_lh <- ggplot(subset(results, Hemisphere == "lh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for LH
axis.title.y = element_text(size = 16),  # Keep y-axis title for LH
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
) +
labs(title = "Left Hemisphere", x = "Mean Difference (3D - 2D)", y = "Visual Cortex Region", fill = "Significance")
# Merge the two plots side-by-side
p_lh+p_rh
# Right Hemisphere (RH) Plot - Reverse X-axis
p_rh <- ggplot(subset(results, Hemisphere == "rh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for RH
axis.title.y = element_blank(),  # Remove y-axis title (keep it only in LH)
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "right"  # Hide legend (we'll keep it in LH plot)
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)")
# Left Hemisphere (LH) Plot - Normal X-axis
p_lh <- ggplot(subset(results, Hemisphere == "lh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for LH
axis.title.y = element_text(size = 16),  # Keep y-axis title for LH
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "none"  # Show legend only in LH plot
) +
labs(title = "Left Hemisphere", x = "Mean Difference (3D - 2D)", y = "Visual Cortex Region", fill = "Significance")
# Merge the two plots side-by-side
p_lh+p_rh
# Right Hemisphere (RH) Plot - Reverse X-axis
p_rh <- ggplot(subset(results, Hemisphere == "rh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "right"  # Hide legend (we'll keep it in LH plot)
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)")
# Left Hemisphere (LH) Plot - Normal X-axis
p_lh <- ggplot(subset(results, Hemisphere == "lh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for LH
axis.title.y = element_text(size = 16),  # Keep y-axis title for LH
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "none"  # Show legend only in LH plot
) +
labs(title = "Left Hemisphere", x = "Mean Difference (3D - 2D)", y = "Visual Cortex Region", fill = "Significance")
# Merge the two plots side-by-side
p_lh+p_rh
# Right Hemisphere (RH) Plot - Reverse X-axis
p_rh <- ggplot(subset(results, Hemisphere == "rh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
axis.title.y = element_blank(),  # Hide y-axis label
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "right"  # Keep legend
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)")
# Left Hemisphere (LH) Plot - Normal X-axis
p_lh <- ggplot(subset(results, Hemisphere == "lh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for LH
axis.title.y = element_text(size = 16),  # Keep y-axis title for LH
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "none"  # Show legend only in LH plot
) +
labs(title = "Left Hemisphere", x = "Mean Difference (3D - 2D)", y = "Visual Cortex Region", fill = "Significance")
# Merge the two plots side-by-side
p_lh+p_rh
# Right Hemisphere (RH) Plot - Reverse X-axis
p_rh <- ggplot(subset(results, Hemisphere == "rh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
axis.title.y = element_blank(),  # Hide y-axis label
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "right"  # Keep legend
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)")
# Left Hemisphere (LH) Plot - Normal X-axis
p_lh <- ggplot(subset(results, Hemisphere == "lh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for LH
axis.title.y = element_text(size = 16),  # Keep y-axis title for LH
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "none"  # Show legend only in LH plot
) +
labs(title = "Left Hemisphere", x = "Mean Difference (3D - 2D)", y = "Visual Cortex Region", fill = "Significance")
# Merge the two plots side-by-side
p_lh+p_rh
# Right Hemisphere (RH) Plot - Reverse X-axis
p_rh <- ggplot(subset(results, Hemisphere == "rh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
axis.title.y = element_blank(),  # Hide y-axis label
axis.text.y = element_text(size = 12),  # Keep y-axis tick labels
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "right"  # Keep legend
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)", y = NULL)  # Explicitly remove y-axis label
# Left Hemisphere (LH) Plot - Normal X-axis
p_lh <- ggplot(subset(results, Hemisphere == "lh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for LH
axis.title.y = element_text(size = 16),  # Keep y-axis title for LH
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "none"  # Show legend only in LH plot
) +
labs(title = "Left Hemisphere", x = "Mean Difference (3D - 2D)", y = "Visual Cortex Region", fill = "Significance")
# Merge the two plots side-by-side
p_lh+p_rh
# Right Hemisphere (RH) Plot - Reverse X-axis
p_rh <- ggplot(subset(results, Hemisphere == "rh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
plot.title = element_text(size = 18, face = "bold"),
legend.position = "right"  # Keep legend
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)", y = NULL)  # Explicitly remove y-axis label
# Left Hemisphere (LH) Plot - Normal X-axis
p_lh <- ggplot(subset(results, Hemisphere == "lh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for LH
axis.title.y = element_text(size = 16),  # Keep y-axis title for LH
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "none"  # Show legend only in LH plot
) +
labs(title = "Left Hemisphere", x = "Mean Difference (3D - 2D)", y = "Visual Cortex Region", fill = "Significance")
# Merge the two plots side-by-side
p_lh+p_rh
# Right Hemisphere (RH) Plot - Reverse X-axis
p_rh <- ggplot(subset(results, Hemisphere == "rh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
axis.title.y = element_blank(),  # Hide y-axis label
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "right"  # Keep legend
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)", y = NULL)  # Explicitly remove y-axis label
# Left Hemisphere (LH) Plot - Normal X-axis
p_lh <- ggplot(subset(results, Hemisphere == "lh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for LH
axis.title.y = element_text(size = 16),  # Keep y-axis title for LH
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "none"  # Show legend only in LH plot
) +
labs(title = "Left Hemisphere", x = "Mean Difference (3D - 2D)", y = "Visual Cortex Region", fill = "Significance")
# Merge the two plots side-by-side
p_lh+p_rh
# Right Hemisphere (RH) Plot - Reverse X-axis
p_rh <- ggplot(subset(results, Hemisphere == "rh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
axis.title.y = element_blank(),  # Hide y-axis label
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "right"  # Keep legend
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)", y = NULL)  # Explicitly remove y-axis label
library(ggplot2)
library(matrixStats)
library(ggplot2)
library(dplyr)
library(tidyr)
library(ggsignif)
library(patchwork)
# Directories for the two conditions
rh_Dir1 <- "C:/Users/Fariv/Desktop/PCA_fMRI/Angela_Movie/Movie1_rh_sigEigen"
rh_Dir2 <- "C:/Users/Fariv/Desktop/PCA_fMRI/Angela_Movie/Movie2_rh_sigEigen"
lh_Dir1 <- "C:/Users/Fariv/Desktop/PCA_fMRI/Angela_Movie/Movie1_lh_sigEigen"
lh_Dir2 <- "C:/Users/Fariv/Desktop/PCA_fMRI/Angela_Movie/Movie2_lh_sigEigen"
# Get file names
rh_file1_names <- list.files(rh_Dir1, pattern = "Movie.*\\.1D$", full.names = TRUE)
rh_file2_names <- list.files(rh_Dir2, pattern = "Movie.*\\.1D$", full.names = TRUE)
lh_file1_names <- list.files(lh_Dir1, pattern = "Movie.*\\.1D$", full.names = TRUE)
lh_file2_names <- list.files(lh_Dir2, pattern = "Movie.*\\.1D$", full.names = TRUE)
# List of regions
region_names <- c("V1", "V2", "V3", "hV4", "VO1", "VO2", "PHC1", "PHC2",
"MST", "hMT", "LO2", "LO1", "V3b", "V3a", "IPS0", "IPS1",
"IPS2", "IPS3", "IPS4", "IPS5", "SPL1", "FEF")
# Initialize results dataframe
results <- data.frame(Region = character(), Hemisphere = character(), MeanDiff = numeric(), p_value = numeric(), Significance = character())
process_hemisphere <- function(hemi, dir1, dir2, file1_names, file2_names) {
hemi_results <- data.frame(Region = character(), Hemisphere = character(), MeanDiff = numeric(), p_value = numeric(), Significance = character())
for (region in region_names) {
region_file_name <- paste0("C:/Users/Fariv/Desktop/PCA_fMRI/Angela_Movie/", hemi, "_", region, ".csv")
regions <- read.csv(region_file_name)
visual_nodes <- regions[, 1]
data_condition1 <- c()
data_condition2 <- c()
for (i in 1:length(file1_names)) {
data1 <- read.table(file1_names[i], header = FALSE)[, 2][visual_nodes]
data2 <- read.table(file2_names[i], header = FALSE)[, 2][visual_nodes]
data_condition1 <- c(data_condition1, data1)
data_condition2 <- c(data_condition2, data2)
}
t_test_result <- t.test(data_condition1, data_condition2, paired = TRUE)
mean_diff <- mean(data_condition2 - data_condition1)
cat("Region:", region, "\\n")
print(t_test_result)
# Determine significance level
significance <- ifelse(t_test_result$p.value < 0.05, "***", "ns")
hemi_results <- rbind(hemi_results, data.frame(Region = region, Hemisphere = hemi, MeanDiff = mean_diff, p_value = t_test_result$p.value, Significance = significance))
}
return(hemi_results)
}
# Process RH and LH data separately
rh_results <- process_hemisphere("rh", rh_Dir1, rh_Dir2, rh_file1_names, rh_file2_names)
lh_results <- process_hemisphere("lh", lh_Dir1, lh_Dir2, lh_file1_names, lh_file2_names)
# Combine both results
results <- rbind(rh_results, lh_results)
# Convert Region and Hemisphere to factor
results$Region <- factor(results$Region, levels = region_names)
results$Hemisphere <- factor(results$Hemisphere, levels = c("lh", "rh"))
# Left Hemisphere (LH) Plot - Normal X-axis
library(ggplot2)
library(patchwork)  # For merging plots
# Right Hemisphere (RH) Plot - Reverse X-axis
p_rh <- ggplot(subset(results, Hemisphere == "rh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
scale_x_reverse() +  # Reverse x-axis only for RH
theme_minimal(base_size = 10) +
theme(
axis.title.y = element_blank(),  # Hide y-axis label
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "right"  # Keep legend
) +
labs(title = "Right Hemisphere", x = "Mean Difference (3D - 2D)", y = NULL)  # Explicitly remove y-axis label
# Left Hemisphere (LH) Plot - Normal X-axis
p_lh <- ggplot(subset(results, Hemisphere == "lh"), aes(y = Region, x = MeanDiff, fill = Significance)) +
geom_bar(stat = "identity", width = 0.7) +
geom_vline(xintercept = 0, linetype = "dashed", color = "black") +
scale_fill_manual(values = c("ns" = "gray", "*" = "blue", "**" = "green", "***" = "red")) +  # Customize colors
theme_minimal(base_size = 10) +
theme(
axis.text.y = element_text(size = 12),  # Keep y-axis labels for LH
axis.title.y = element_text(size = 16),  # Keep y-axis title for LH
axis.title.x = element_text(size = 16),
plot.title = element_text(size = 18, face = "bold"),
legend.position = "none"  # Show legend only in LH plot
) +
labs(title = "Left Hemisphere", x = "Mean Difference (3D - 2D)", y = "Visual Cortex Region", fill = "Significance")
# Merge the two plots side-by-side
p_lh+p_rh
BaseDir <- "C:/Users/Fariv/Desktop/PCA_fMRI/Angela_Movie/Movie2_"
directories <- c("rh_csv",
"rh_eigen",
"rh_scram",
"rh_sigPC",
"rh_Z_sigPC",
"rh_scalePC1",
"rh_PC1",
"rh_Tmean",
"rh_ratio",
"rh_sigEigen")
for (dir in directories) {
dir_path <- paste0(BaseDir, dir)
if (!dir.exists(dir_path)) {
dir.create(dir_path, recursive = TRUE)
message("Created directory: ", dir_path)
} else {
message("Directory already exists: ", dir_path)
}
}
Raw=paste0(BaseDir,"rh_csv")
PCA_eigenvalues_directory=paste0(BaseDir,"rh_eigen")
PCA_scram_directory=paste0(BaseDir,"rh_scram")
PCA_Signifnum_directory=paste0(BaseDir,"rh_sigPC")
PCA_ZSignifnum_directory=paste0(BaseDir,"rh_Z_sigPC")
PCA_scalePC_directory=paste0(BaseDir,"rh_scalePC1")
PCA_PC1_directory=paste0(BaseDir,"rh_PC1")
PCA_Tmean_directory=paste0(BaseDir,"rh_Tmean")
PCA_ratio_directory=paste0(BaseDir,"rh_ratio")
PCA_sigEigen_directory=paste0(BaseDir,"rh_sigEigen")
dir=PCA_sigEigen_directory
file_names <- list.files(dir,pattern = "\\.1D$")
out_file_name <- "nat2_mean_rh_sigEigen.1D"
data_matrix <- matrix(NA, nrow = 36001, ncol = length(file_names))
for (i in 1:length(file_names)) {
file_data <- read.table(paste0(dir,"/",file_names[i]), header = FALSE)
data_matrix[, i] <- file_data[, 2]
}
mean_values <- rowMeans(data_matrix, na.rm = TRUE)  # na.rm=TRUE to handle any NAs
mean_data <- data.frame(Index = 1:36001, Mean = mean_values)
write.table(mean_data, paste0(dir,"/",out_file_name), row.names = FALSE, col.names = FALSE, sep = " ")
BaseDir <- "C:/Users/Fariv/Desktop/PCA_fMRI/Angela_Movie/Movie1_"
directories <- c("rh_csv",
"rh_eigen",
"rh_scram",
"rh_sigPC",
"rh_Z_sigPC",
"rh_scalePC1",
"rh_PC1",
"rh_Tmean",
"rh_ratio",
"rh_sigEigen")
for (dir in directories) {
dir_path <- paste0(BaseDir, dir)
if (!dir.exists(dir_path)) {
dir.create(dir_path, recursive = TRUE)
message("Created directory: ", dir_path)
} else {
message("Directory already exists: ", dir_path)
}
}
Raw=paste0(BaseDir,"rh_csv")
PCA_eigenvalues_directory=paste0(BaseDir,"rh_eigen")
PCA_scram_directory=paste0(BaseDir,"rh_scram")
PCA_Signifnum_directory=paste0(BaseDir,"rh_sigPC")
PCA_ZSignifnum_directory=paste0(BaseDir,"rh_Z_sigPC")
PCA_scalePC_directory=paste0(BaseDir,"rh_scalePC1")
PCA_PC1_directory=paste0(BaseDir,"rh_PC1")
PCA_Tmean_directory=paste0(BaseDir,"rh_Tmean")
PCA_ratio_directory=paste0(BaseDir,"rh_ratio")
PCA_sigEigen_directory=paste0(BaseDir,"rh_sigEigen")
dir=PCA_sigEigen_directory
file_names <- list.files(dir,pattern = "\\.1D$")
out_file_name <- "nat1_mean_rh_sigEigen.1D"
data_matrix <- matrix(NA, nrow = 36001, ncol = length(file_names))
for (i in 1:length(file_names)) {
file_data <- read.table(paste0(dir,"/",file_names[i]), header = FALSE)
data_matrix[, i] <- file_data[, 2]
}
mean_values <- rowMeans(data_matrix, na.rm = TRUE)  # na.rm=TRUE to handle any NAs
mean_data <- data.frame(Index = 1:36001, Mean = mean_values)
write.table(mean_data, paste0(dir,"/",out_file_name), row.names = FALSE, col.names = FALSE, sep = " ")
setwd("C:/Users/Fariv/Desktop/Natural_Movie_analysis/CODES")
LS
ls
